// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id        Int      @id @default(autoincrement())
  nome      String
  email     String   @unique
  senha     String
  tipo      String   // ADMIN, ATENDENTE
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relacionamentos
  atendente Atendente?

  @@map("usuarios")
}

model Servico {
  id               Int      @id @default(autoincrement())
  nome             String
  descricao        String?
  preco            Decimal  @db.Decimal(10, 2)
  duracaoMinutos   Int      @map("duracao")
  ativo            Boolean  @default(true)
  empresaId        Int      @default(1)
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  // Relacionamentos
  agendamentos Agendamento[]

  @@map("servicos")
}

model Atendente {
  id             Int      @id @default(autoincrement())
  usuarioId      Int      @unique
  especialidades String[] // Array de strings
  corAgenda      String   @map("cor")
  ativo          Boolean  @default(true)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  // Relacionamentos
  usuario      Usuario       @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  agendamentos Agendamento[]

  @@map("atendentes")
}

model Agendamento {
  id              Int      @id @default(autoincrement())
  clienteNome     String
  clienteTelefone String
  clienteEmail    String?
  clienteObs      String?
  servicoId       Int
  atendenteId     Int
  dataHora        DateTime
  status          String   @default("CONFIRMADO") // CONFIRMADO, CANCELADO, CONCLUIDO
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  // Relacionamentos
  servico   Servico   @relation(fields: [servicoId], references: [id])
  atendente Atendente @relation(fields: [atendenteId], references: [id])

  @@map("agendamentos")
}
